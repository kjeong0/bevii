<head>
    <title>Bevii</title>
</head>

<body>
    <!-- Fixed navbar -->
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand" href="#">Bevii&nbsp;&nbsp;&nbsp;<small>{{> userCountMini}}</small></a>
        </div>
          <ul class="nav navbar-nav navbar-right">
            {{> loginButtons}}
          </ul>
      </div>
    </nav>

    <div class="container">
        {{> userCount}}
        {{#if currentUser}}
            {{> rps}}
        {{/if}}
        {{> followers}}
    </div>
</body>

<template name="_loginButtonsAdditionalLoggedInDropdownActions">
    {{#with currentUser}}
        {{#with profile}}
            <h4>{{first_name}}&nbsp;{{last_name}}</h4>
        {{/with}}
    {{/with}}
</template>

<template name="matches">
    {{#each matches}}
        matchName
    {{/each}}
</template>

<template name="rps">
    {{#if userInMatch}}
        {{#each matches}}
            <div>
                {{#if makeMove}}
                    <h3>{{playerOne}} vs. {{playerTwo}}</h3>
                    <div>
                        <button id="rock" class="btn btn-default rps" value="rock"><img src="/images/Rock-50.png" /></button>
                        <button id="paper" class="btn btn-default rps" value="paper"><img src="/images/Paper-50.png" /></button>
                        <button id="scissors" class="btn btn-default rps" value="scissors"><img src="/images/Scissors-50.png" /></button>
                        <p>Select your move!</p>
                    </div>
                {{else}}
                    {{#if waitingForOtherPlayer}}
                        <h3>{{playerOne}} vs. {{playerTwo}}</h3>
                        <div>Waiting for other player</div>
                    {{/if}}
                {{/if}}
            </div>
        {{/each}}
    {{else}}
        <div>
            <p>Challenge someone above!</p>
        </div>
    {{/if}}

    <div>
        <h2>Match History</h2>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Opponent</th>
                    <th>Outcome</th>
                </tr>
            </thead>
            <tbody>
                {{#each matches}}
                    {{#unless makeMove}}
                        {{#unless waitingForOtherPlayer}}
                            <tr>
                                <td>{{matchDate}}</td>
                                <td>{{matchOpponent}}</td>
                                <td>{{matchOutcome}}</td>
                            </tr>
                        {{/unless}}
                    {{/unless}}
                {{/each}}
            </tbody>
        </table>
    </div>
</template>

<template name="followers">
    <h2>Followers</h2>
    {{#each leaders}}
        <div>
            Leader: {{leader}} | Followers: {{followers}}
        </div>
    {{/each}} 
</template>

<template name="userCount">
    <div>
        <h2>{{usersOnlineCount}} player(s) online</h2>
        <h2>Challenge someone!</h2>
        {{#each usersOnline}}
            <div>
                <button class="btn btn-default user" value="{{username}}">{{username}}</button>
            </div>
        {{/each}}
    </div>
</template>

<template name="userCountMini">
    {{usersOnlineCount}} player(s) online
</template>